{"ast":null,"code":"/**\n * Avatar Service for managing AI interviewer avatar\n */\nexport class AvatarService {\n  constructor() {\n    this.avatarElement = null;\n    this.isAnimating = false;\n    this.currentAudio = null;\n    this.audioContext = null;\n    this.analyser = null;\n    this.dataArray = null;\n    this.animationFrame = null;\n  }\n\n  /**\n   * Initialize avatar with DOM element\n   * @param {HTMLElement} avatarElement - Avatar DOM element\n   */\n  initialize(avatarElement) {\n    this.avatarElement = avatarElement;\n    this.setupAudioContext();\n    this.createAvatarVisuals();\n  }\n\n  /**\n   * Setup Web Audio API context for real-time audio analysis\n   */\n  setupAudioContext() {\n    try {\n      this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n      this.analyser = this.audioContext.createAnalyser();\n      this.analyser.fftSize = 256;\n      this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n    } catch (error) {\n      console.warn('Web Audio API not supported, using fallback animation');\n    }\n  }\n\n  // Replace the existing createAvatarVisuals function with this one\n\n  /**\n   * Create avatar visual elements and return the container\n   * @returns {HTMLElement | null} The created avatar container element or null\n   */\n  createAvatarVisuals() {\n    // 1. Create the main container element dynamically\n    const container = document.createElement('div');\n    container.className = 'avatar-interviewer'; // Add base class\n\n    // 2. Set its inner HTML\n    container.innerHTML = `\n      <div class=\"avatar-container\">\n        <div class=\"avatar-head\">\n          <div class=\"avatar-face\">\n            <div class=\"avatar-eyes\">\n              <div class=\"avatar-eye left\"><div class=\"pupil\"></div><div class=\"eyelid\"></div></div>\n              <div class=\"avatar-eye right\"><div class=\"pupil\"></div><div class=\"eyelid\"></div></div>\n            </div>\n            <div class=\"avatar-nose\"></div>\n            <div class=\"avatar-mouth\">\n              <div class=\"avatar-lips\">\n                <div class=\"upper-lip\"></div>\n                <div class=\"lower-lip\"></div>\n                <div class=\"mouth-opening\"></div>\n              </div>\n            </div>\n            <div class=\"avatar-cheeks\">\n              <div class=\"cheek left\"></div>\n              <div class=\"cheek right\"></div>\n            </div>\n          </div>\n          <div class=\"avatar-hair\"></div>\n        </div>\n        <div class=\"avatar-body\">\n          <div class=\"avatar-torso\"></div>\n          <div class=\"avatar-arms\">\n            <div class=\"arm left\"></div>\n            <div class=\"arm right\"></div>\n          </div>\n        </div>\n      </div>\n    `;\n\n    // 3. Ensure styles are added (can be called separately if needed)\n    this.addAvatarStyles();\n\n    // 4. Return the created container element\n    return container;\n  }\n\n  /**\n   * Add CSS styles for the avatar\n   */\n  addAvatarStyles() {\n    if (document.getElementById('avatar-styles')) return;\n    const style = document.createElement('style');\n    style.id = 'avatar-styles';\n    style.textContent = `\n      .avatar-interviewer {\n        position: relative;\n        width: 100%;\n        height: 100%;\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        border-radius: 20px;\n        overflow: hidden;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        box-shadow: 0 10px 30px rgba(0,0,0,0.3);\n      }\n\n      .avatar-container {\n        position: relative;\n        width: 200px;\n        height: 250px;\n        transform-style: preserve-3d;\n        animation: float 3s ease-in-out infinite;\n      }\n\n      @keyframes float {\n        0%, 100% { transform: translateY(0px); }\n        50% { transform: translateY(-10px); }\n      }\n\n      .avatar-head {\n        position: relative;\n        width: 120px;\n        height: 120px;\n        background: #fdbcb4;\n        border-radius: 50%;\n        margin: 0 auto 20px;\n        box-shadow: 0 5px 15px rgba(0,0,0,0.2);\n        transform-style: preserve-3d;\n      }\n\n      .avatar-face {\n        position: relative;\n        width: 100%;\n        height: 100%;\n        border-radius: 50%;\n        overflow: hidden;\n      }\n\n      .avatar-eyes {\n        position: absolute;\n        top: 30px;\n        left: 50%;\n        transform: translateX(-50%);\n        display: flex;\n        gap: 20px;\n      }\n\n      .avatar-eye {\n        position: relative;\n        width: 20px;\n        height: 20px;\n        background: white;\n        border-radius: 50%;\n        box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);\n      }\n\n      .pupil {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        width: 12px;\n        height: 12px;\n        background: #333;\n        border-radius: 50%;\n        transition: all 0.1s ease;\n      }\n\n      .eyelid {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 50%;\n        background: #fdbcb4;\n        border-radius: 50% 50% 0 0;\n        transition: transform 0.1s ease;\n      }\n\n      .avatar-nose {\n        position: absolute;\n        top: 50px;\n        left: 50%;\n        transform: translateX(-50%);\n        width: 8px;\n        height: 12px;\n        background: #f4a5a5;\n        border-radius: 50%;\n      }\n\n      .avatar-mouth {\n        position: absolute;\n        top: 70px;\n        left: 50%;\n        transform: translateX(-50%);\n        width: 40px;\n        height: 20px;\n      }\n\n      .avatar-lips {\n        position: relative;\n        width: 100%;\n        height: 100%;\n      }\n\n      .upper-lip, .lower-lip {\n        position: absolute;\n        width: 100%;\n        height: 50%;\n        background: #d63384;\n        border-radius: 50%;\n        transition: all 0.1s ease;\n      }\n\n      .upper-lip {\n        top: 0;\n        border-radius: 50% 50% 0 0;\n      }\n\n      .lower-lip {\n        bottom: 0;\n        border-radius: 0 0 50% 50%;\n      }\n\n      .mouth-opening {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        width: 20px;\n        height: 8px;\n        background: #000;\n        border-radius: 50%;\n        opacity: 0;\n        transition: all 0.1s ease;\n      }\n\n      .avatar-cheeks {\n        position: absolute;\n        top: 50px;\n        left: 0;\n        right: 0;\n        height: 30px;\n      }\n\n      .cheek {\n        position: absolute;\n        top: 0;\n        width: 20px;\n        height: 20px;\n        background: #ffb3ba;\n        border-radius: 50%;\n        opacity: 0;\n        transition: opacity 0.3s ease;\n      }\n\n      .cheek.left {\n        left: 10px;\n      }\n\n      .cheek.right {\n        right: 10px;\n      }\n\n      .avatar-hair {\n        position: absolute;\n        top: -10px;\n        left: 50%;\n        transform: translateX(-50%);\n        width: 100px;\n        height: 40px;\n        background: #8b4513;\n        border-radius: 50% 50% 0 0;\n        z-index: -1;\n      }\n\n      .avatar-body {\n        position: relative;\n        width: 80px;\n        height: 100px;\n        background: #4a90e2;\n        border-radius: 20px;\n        margin: 0 auto;\n        box-shadow: 0 5px 15px rgba(0,0,0,0.2);\n      }\n\n      .avatar-torso {\n        width: 100%;\n        height: 60px;\n        background: #4a90e2;\n        border-radius: 20px 20px 10px 10px;\n      }\n\n      .avatar-arms {\n        position: absolute;\n        top: 10px;\n        left: 0;\n        right: 0;\n        height: 40px;\n      }\n\n      .arm {\n        position: absolute;\n        width: 15px;\n        height: 40px;\n        background: #fdbcb4;\n        border-radius: 10px;\n      }\n\n      .arm.left {\n        left: -10px;\n        top: 10px;\n        transform: rotate(-20deg);\n      }\n\n      .arm.right {\n        right: -10px;\n        top: 10px;\n        transform: rotate(20deg);\n      }\n\n      /* Expression styles */\n      .expression-happy .avatar-eyes {\n        transform: translateX(-50%) scaleY(0.8);\n      }\n\n      .expression-happy .avatar-lips {\n        transform: scaleY(1.2);\n      }\n\n      .expression-happy .cheek {\n        opacity: 1;\n      }\n\n      .expression-serious .avatar-eyes {\n        transform: translateX(-50%) scaleY(1.2);\n      }\n\n      .expression-serious .avatar-lips {\n        transform: scaleY(0.8);\n      }\n\n      .expression-thinking .avatar-eyes {\n        transform: translateX(-50%) scaleY(0.6);\n      }\n\n      .expression-thinking .avatar-lips {\n        transform: scaleY(0.9);\n      }\n\n      /* Speaking animation */\n      .speaking .mouth-opening {\n        opacity: 1;\n        animation: mouth-move 0.1s ease-in-out infinite alternate;\n      }\n\n      @keyframes mouth-move {\n        0% { transform: translate(-50%, -50%) scaleY(1); }\n        100% { transform: translate(-50%, -50%) scaleY(1.5); }\n      }\n\n      /* Blinking animation */\n      .avatar-eye .eyelid {\n        animation: blink 4s infinite;\n      }\n\n      @keyframes blink {\n        0%, 90%, 100% { transform: scaleY(1); }\n        95% { transform: scaleY(0.1); }\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  /**\n   * Start speaking animation with audio\n   * @param {Blob} audioBlob - Audio blob to play\n   * @param {string} text - Text being spoken (for fallback)\n   */\n  async startSpeaking(audioBlob, text = '') {\n    if (this.isAnimating) {\n      await this.stopSpeaking();\n    }\n    this.isAnimating = true;\n\n    // Add speaking class for CSS animations\n    if (this.avatarElement) {\n      this.avatarElement.classList.add('speaking');\n    }\n    try {\n      if (this.audioContext && audioBlob) {\n        await this.playAudioWithLipSync(audioBlob);\n      } else {\n        // Fallback: animate based on text length\n        this.animateWithText(text);\n      }\n    } catch (error) {\n      console.error('Failed to start speaking animation:', error);\n      // Fallback animation\n      this.animateWithText(text);\n    }\n  }\n\n  /**\n   * Play audio with real-time lip sync\n   * @param {Blob} audioBlob - Audio to play\n   */\n  async playAudioWithLipSync(audioBlob) {\n    try {\n      const arrayBuffer = await audioBlob.arrayBuffer();\n      const audioBuffer = await this.audioContext.decodeAudioData(arrayBuffer);\n      const source = this.audioContext.createBufferSource();\n      source.buffer = audioBuffer;\n      source.connect(this.analyser);\n      this.analyser.connect(this.audioContext.destination);\n      this.currentAudio = source;\n\n      // Start lip sync animation\n      this.startLipSyncAnimation();\n\n      // Play audio\n      source.start(0);\n\n      // Stop animation when audio ends\n      source.onended = () => {\n        this.stopSpeaking();\n      };\n    } catch (error) {\n      console.error('Audio playback failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Start lip sync animation based on audio frequency\n   */\n  startLipSyncAnimation() {\n    const animate = () => {\n      if (!this.isAnimating) return;\n      this.analyser.getByteFrequencyData(this.dataArray);\n\n      // Calculate more sophisticated audio analysis\n      const average = this.dataArray.reduce((a, b) => a + b) / this.dataArray.length;\n      const max = Math.max(...this.dataArray);\n      const min = Math.min(...this.dataArray);\n\n      // Normalize to 0-1 with better scaling\n      const normalized = Math.min(1, (average + (max - min) * 0.3) / 255);\n\n      // Apply mouth animation with more realistic movement\n      this.animateMouth(normalized);\n      this.animationFrame = requestAnimationFrame(animate);\n    };\n    animate();\n  }\n\n  /**\n   * Animate mouth based on audio intensity\n   * @param {number} intensity - Audio intensity (0-1)\n   */\n  animateMouth(intensity) {\n    var _this$avatarElement, _this$avatarElement2;\n    const lips = (_this$avatarElement = this.avatarElement) === null || _this$avatarElement === void 0 ? void 0 : _this$avatarElement.querySelector('.avatar-lips');\n    const mouthOpening = (_this$avatarElement2 = this.avatarElement) === null || _this$avatarElement2 === void 0 ? void 0 : _this$avatarElement2.querySelector('.mouth-opening');\n    if (!lips || !mouthOpening) return;\n\n    // More realistic mouth movement\n    const scale = 1 + intensity * 0.8;\n    const mouthScale = 0.5 + intensity * 1.5;\n\n    // Animate lips\n    lips.style.transform = `scaleY(${scale})`;\n\n    // Animate mouth opening\n    mouthOpening.style.transform = `translate(-50%, -50%) scaleY(${mouthScale})`;\n    mouthOpening.style.opacity = Math.min(1, intensity * 2);\n\n    // Add some randomness for natural movement\n    const randomOffset = (Math.random() - 0.5) * 0.2;\n    lips.style.transform += ` translateY(${randomOffset}px)`;\n  }\n\n  /**\n   * Fallback animation based on text length\n   * @param {string} text - Text to animate for\n   */\n  animateWithText(text) {\n    const duration = Math.max(text.length * 100, 2000); // 100ms per character, min 2s\n\n    this.animateMouth(0.5); // Medium intensity\n\n    setTimeout(() => {\n      this.stopSpeaking();\n    }, duration);\n  }\n\n  /**\n   * Stop speaking animation\n   */\n  async stopSpeaking() {\n    var _this$avatarElement3;\n    this.isAnimating = false;\n\n    // Remove speaking class\n    if (this.avatarElement) {\n      this.avatarElement.classList.remove('speaking');\n    }\n    if (this.currentAudio) {\n      this.currentAudio.stop();\n      this.currentAudio = null;\n    }\n    if (this.animationFrame) {\n      cancelAnimationFrame(this.animationFrame);\n      this.animationFrame = null;\n    }\n\n    // Reset mouth to neutral position\n    const lips = (_this$avatarElement3 = this.avatarElement) === null || _this$avatarElement3 === void 0 ? void 0 : _this$avatarElement3.querySelector('.avatar-lips');\n    if (lips) {\n      lips.style.transform = 'scaleY(1) translateY(0px)';\n    }\n  }\n\n  /**\n   * Set avatar expression\n   * @param {string} expression - Expression type (happy, serious, thinking, etc.)\n   */\n  setExpression(expression) {\n    if (!this.avatarElement) return;\n\n    // Remove previous expression classes\n    this.avatarElement.classList.remove('expression-happy', 'expression-serious', 'expression-thinking');\n\n    // Add new expression class\n    this.avatarElement.classList.add(`expression-${expression}`);\n\n    // Update visual elements based on expression\n    this.updateExpressionVisuals(expression);\n  }\n\n  /**\n   * Update visual elements for expression\n   * @param {string} expression - Expression type\n   */\n  updateExpressionVisuals(expression) {\n    var _this$avatarElement4, _this$avatarElement5;\n    const eyes = (_this$avatarElement4 = this.avatarElement) === null || _this$avatarElement4 === void 0 ? void 0 : _this$avatarElement4.querySelector('.avatar-eyes');\n    const mouth = (_this$avatarElement5 = this.avatarElement) === null || _this$avatarElement5 === void 0 ? void 0 : _this$avatarElement5.querySelector('.avatar-mouth');\n    if (!eyes || !mouth) return;\n    switch (expression) {\n      case 'happy':\n        eyes.style.transform = 'scaleY(0.8)';\n        mouth.style.transform = 'scaleY(1.2)';\n        break;\n      case 'serious':\n        eyes.style.transform = 'scaleY(1.2)';\n        mouth.style.transform = 'scaleY(0.8)';\n        break;\n      case 'thinking':\n        eyes.style.transform = 'scaleY(0.6)';\n        mouth.style.transform = 'scaleY(0.9)';\n        break;\n      default:\n        eyes.style.transform = 'scaleY(1)';\n        mouth.style.transform = 'scaleY(1)';\n    }\n  }\n\n  /**\n   * Cleanup resources\n   */\n  destroy() {\n    this.stopSpeaking();\n    if (this.audioContext) {\n      this.audioContext.close();\n      this.audioContext = null;\n    }\n    this.avatarElement = null;\n  }\n}\n\n// Global instance\nexport const avatarService = new AvatarService();","map":{"version":3,"names":["AvatarService","constructor","avatarElement","isAnimating","currentAudio","audioContext","analyser","dataArray","animationFrame","initialize","setupAudioContext","createAvatarVisuals","window","AudioContext","webkitAudioContext","createAnalyser","fftSize","Uint8Array","frequencyBinCount","error","console","warn","container","document","createElement","className","innerHTML","addAvatarStyles","getElementById","style","id","textContent","head","appendChild","startSpeaking","audioBlob","text","stopSpeaking","classList","add","playAudioWithLipSync","animateWithText","arrayBuffer","audioBuffer","decodeAudioData","source","createBufferSource","buffer","connect","destination","startLipSyncAnimation","start","onended","animate","getByteFrequencyData","average","reduce","a","b","length","max","Math","min","normalized","animateMouth","requestAnimationFrame","intensity","_this$avatarElement","_this$avatarElement2","lips","querySelector","mouthOpening","scale","mouthScale","transform","opacity","randomOffset","random","duration","setTimeout","_this$avatarElement3","remove","stop","cancelAnimationFrame","setExpression","expression","updateExpressionVisuals","_this$avatarElement4","_this$avatarElement5","eyes","mouth","destroy","close","avatarService"],"sources":["D:/ai_avatar/frontend/src/services/avatarService.js"],"sourcesContent":["/**\n * Avatar Service for managing AI interviewer avatar\n */\nexport class AvatarService {\n  constructor() {\n    this.avatarElement = null;\n    this.isAnimating = false;\n    this.currentAudio = null;\n    this.audioContext = null;\n    this.analyser = null;\n    this.dataArray = null;\n    this.animationFrame = null;\n  }\n\n  /**\n   * Initialize avatar with DOM element\n   * @param {HTMLElement} avatarElement - Avatar DOM element\n   */\n  initialize(avatarElement) {\n    this.avatarElement = avatarElement;\n    this.setupAudioContext();\n    this.createAvatarVisuals();\n  }\n\n  /**\n   * Setup Web Audio API context for real-time audio analysis\n   */\n  setupAudioContext() {\n    try {\n      this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n      this.analyser = this.audioContext.createAnalyser();\n      this.analyser.fftSize = 256;\n      this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n    } catch (error) {\n      console.warn('Web Audio API not supported, using fallback animation');\n    }\n  }\n\n// Replace the existing createAvatarVisuals function with this one\n\n  /**\n   * Create avatar visual elements and return the container\n   * @returns {HTMLElement | null} The created avatar container element or null\n   */\n  createAvatarVisuals() {\n    // 1. Create the main container element dynamically\n    const container = document.createElement('div');\n    container.className = 'avatar-interviewer'; // Add base class\n\n    // 2. Set its inner HTML\n    container.innerHTML = `\n      <div class=\"avatar-container\">\n        <div class=\"avatar-head\">\n          <div class=\"avatar-face\">\n            <div class=\"avatar-eyes\">\n              <div class=\"avatar-eye left\"><div class=\"pupil\"></div><div class=\"eyelid\"></div></div>\n              <div class=\"avatar-eye right\"><div class=\"pupil\"></div><div class=\"eyelid\"></div></div>\n            </div>\n            <div class=\"avatar-nose\"></div>\n            <div class=\"avatar-mouth\">\n              <div class=\"avatar-lips\">\n                <div class=\"upper-lip\"></div>\n                <div class=\"lower-lip\"></div>\n                <div class=\"mouth-opening\"></div>\n              </div>\n            </div>\n            <div class=\"avatar-cheeks\">\n              <div class=\"cheek left\"></div>\n              <div class=\"cheek right\"></div>\n            </div>\n          </div>\n          <div class=\"avatar-hair\"></div>\n        </div>\n        <div class=\"avatar-body\">\n          <div class=\"avatar-torso\"></div>\n          <div class=\"avatar-arms\">\n            <div class=\"arm left\"></div>\n            <div class=\"arm right\"></div>\n          </div>\n        </div>\n      </div>\n    `;\n\n    // 3. Ensure styles are added (can be called separately if needed)\n    this.addAvatarStyles(); \n    \n    // 4. Return the created container element\n    return container; \n  }\n\n  /**\n   * Add CSS styles for the avatar\n   */\n  addAvatarStyles() {\n    if (document.getElementById('avatar-styles')) return;\n\n    const style = document.createElement('style');\n    style.id = 'avatar-styles';\n    style.textContent = `\n      .avatar-interviewer {\n        position: relative;\n        width: 100%;\n        height: 100%;\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        border-radius: 20px;\n        overflow: hidden;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        box-shadow: 0 10px 30px rgba(0,0,0,0.3);\n      }\n\n      .avatar-container {\n        position: relative;\n        width: 200px;\n        height: 250px;\n        transform-style: preserve-3d;\n        animation: float 3s ease-in-out infinite;\n      }\n\n      @keyframes float {\n        0%, 100% { transform: translateY(0px); }\n        50% { transform: translateY(-10px); }\n      }\n\n      .avatar-head {\n        position: relative;\n        width: 120px;\n        height: 120px;\n        background: #fdbcb4;\n        border-radius: 50%;\n        margin: 0 auto 20px;\n        box-shadow: 0 5px 15px rgba(0,0,0,0.2);\n        transform-style: preserve-3d;\n      }\n\n      .avatar-face {\n        position: relative;\n        width: 100%;\n        height: 100%;\n        border-radius: 50%;\n        overflow: hidden;\n      }\n\n      .avatar-eyes {\n        position: absolute;\n        top: 30px;\n        left: 50%;\n        transform: translateX(-50%);\n        display: flex;\n        gap: 20px;\n      }\n\n      .avatar-eye {\n        position: relative;\n        width: 20px;\n        height: 20px;\n        background: white;\n        border-radius: 50%;\n        box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);\n      }\n\n      .pupil {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        width: 12px;\n        height: 12px;\n        background: #333;\n        border-radius: 50%;\n        transition: all 0.1s ease;\n      }\n\n      .eyelid {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 50%;\n        background: #fdbcb4;\n        border-radius: 50% 50% 0 0;\n        transition: transform 0.1s ease;\n      }\n\n      .avatar-nose {\n        position: absolute;\n        top: 50px;\n        left: 50%;\n        transform: translateX(-50%);\n        width: 8px;\n        height: 12px;\n        background: #f4a5a5;\n        border-radius: 50%;\n      }\n\n      .avatar-mouth {\n        position: absolute;\n        top: 70px;\n        left: 50%;\n        transform: translateX(-50%);\n        width: 40px;\n        height: 20px;\n      }\n\n      .avatar-lips {\n        position: relative;\n        width: 100%;\n        height: 100%;\n      }\n\n      .upper-lip, .lower-lip {\n        position: absolute;\n        width: 100%;\n        height: 50%;\n        background: #d63384;\n        border-radius: 50%;\n        transition: all 0.1s ease;\n      }\n\n      .upper-lip {\n        top: 0;\n        border-radius: 50% 50% 0 0;\n      }\n\n      .lower-lip {\n        bottom: 0;\n        border-radius: 0 0 50% 50%;\n      }\n\n      .mouth-opening {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        width: 20px;\n        height: 8px;\n        background: #000;\n        border-radius: 50%;\n        opacity: 0;\n        transition: all 0.1s ease;\n      }\n\n      .avatar-cheeks {\n        position: absolute;\n        top: 50px;\n        left: 0;\n        right: 0;\n        height: 30px;\n      }\n\n      .cheek {\n        position: absolute;\n        top: 0;\n        width: 20px;\n        height: 20px;\n        background: #ffb3ba;\n        border-radius: 50%;\n        opacity: 0;\n        transition: opacity 0.3s ease;\n      }\n\n      .cheek.left {\n        left: 10px;\n      }\n\n      .cheek.right {\n        right: 10px;\n      }\n\n      .avatar-hair {\n        position: absolute;\n        top: -10px;\n        left: 50%;\n        transform: translateX(-50%);\n        width: 100px;\n        height: 40px;\n        background: #8b4513;\n        border-radius: 50% 50% 0 0;\n        z-index: -1;\n      }\n\n      .avatar-body {\n        position: relative;\n        width: 80px;\n        height: 100px;\n        background: #4a90e2;\n        border-radius: 20px;\n        margin: 0 auto;\n        box-shadow: 0 5px 15px rgba(0,0,0,0.2);\n      }\n\n      .avatar-torso {\n        width: 100%;\n        height: 60px;\n        background: #4a90e2;\n        border-radius: 20px 20px 10px 10px;\n      }\n\n      .avatar-arms {\n        position: absolute;\n        top: 10px;\n        left: 0;\n        right: 0;\n        height: 40px;\n      }\n\n      .arm {\n        position: absolute;\n        width: 15px;\n        height: 40px;\n        background: #fdbcb4;\n        border-radius: 10px;\n      }\n\n      .arm.left {\n        left: -10px;\n        top: 10px;\n        transform: rotate(-20deg);\n      }\n\n      .arm.right {\n        right: -10px;\n        top: 10px;\n        transform: rotate(20deg);\n      }\n\n      /* Expression styles */\n      .expression-happy .avatar-eyes {\n        transform: translateX(-50%) scaleY(0.8);\n      }\n\n      .expression-happy .avatar-lips {\n        transform: scaleY(1.2);\n      }\n\n      .expression-happy .cheek {\n        opacity: 1;\n      }\n\n      .expression-serious .avatar-eyes {\n        transform: translateX(-50%) scaleY(1.2);\n      }\n\n      .expression-serious .avatar-lips {\n        transform: scaleY(0.8);\n      }\n\n      .expression-thinking .avatar-eyes {\n        transform: translateX(-50%) scaleY(0.6);\n      }\n\n      .expression-thinking .avatar-lips {\n        transform: scaleY(0.9);\n      }\n\n      /* Speaking animation */\n      .speaking .mouth-opening {\n        opacity: 1;\n        animation: mouth-move 0.1s ease-in-out infinite alternate;\n      }\n\n      @keyframes mouth-move {\n        0% { transform: translate(-50%, -50%) scaleY(1); }\n        100% { transform: translate(-50%, -50%) scaleY(1.5); }\n      }\n\n      /* Blinking animation */\n      .avatar-eye .eyelid {\n        animation: blink 4s infinite;\n      }\n\n      @keyframes blink {\n        0%, 90%, 100% { transform: scaleY(1); }\n        95% { transform: scaleY(0.1); }\n      }\n    `;\n    \n    document.head.appendChild(style);\n  }\n\n  /**\n   * Start speaking animation with audio\n   * @param {Blob} audioBlob - Audio blob to play\n   * @param {string} text - Text being spoken (for fallback)\n   */\n  async startSpeaking(audioBlob, text = '') {\n    if (this.isAnimating) {\n      await this.stopSpeaking();\n    }\n\n    this.isAnimating = true;\n    \n    // Add speaking class for CSS animations\n    if (this.avatarElement) {\n      this.avatarElement.classList.add('speaking');\n    }\n    \n    try {\n      if (this.audioContext && audioBlob) {\n        await this.playAudioWithLipSync(audioBlob);\n      } else {\n        // Fallback: animate based on text length\n        this.animateWithText(text);\n      }\n    } catch (error) {\n      console.error('Failed to start speaking animation:', error);\n      // Fallback animation\n      this.animateWithText(text);\n    }\n  }\n\n  /**\n   * Play audio with real-time lip sync\n   * @param {Blob} audioBlob - Audio to play\n   */\n  async playAudioWithLipSync(audioBlob) {\n    try {\n      const arrayBuffer = await audioBlob.arrayBuffer();\n      const audioBuffer = await this.audioContext.decodeAudioData(arrayBuffer);\n      \n      const source = this.audioContext.createBufferSource();\n      source.buffer = audioBuffer;\n      source.connect(this.analyser);\n      this.analyser.connect(this.audioContext.destination);\n      \n      this.currentAudio = source;\n      \n      // Start lip sync animation\n      this.startLipSyncAnimation();\n      \n      // Play audio\n      source.start(0);\n      \n      // Stop animation when audio ends\n      source.onended = () => {\n        this.stopSpeaking();\n      };\n      \n    } catch (error) {\n      console.error('Audio playback failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Start lip sync animation based on audio frequency\n   */\n  startLipSyncAnimation() {\n    const animate = () => {\n      if (!this.isAnimating) return;\n      \n      this.analyser.getByteFrequencyData(this.dataArray);\n      \n      // Calculate more sophisticated audio analysis\n      const average = this.dataArray.reduce((a, b) => a + b) / this.dataArray.length;\n      const max = Math.max(...this.dataArray);\n      const min = Math.min(...this.dataArray);\n      \n      // Normalize to 0-1 with better scaling\n      const normalized = Math.min(1, (average + (max - min) * 0.3) / 255);\n      \n      // Apply mouth animation with more realistic movement\n      this.animateMouth(normalized);\n      \n      this.animationFrame = requestAnimationFrame(animate);\n    };\n    \n    animate();\n  }\n\n  /**\n   * Animate mouth based on audio intensity\n   * @param {number} intensity - Audio intensity (0-1)\n   */\n  animateMouth(intensity) {\n    const lips = this.avatarElement?.querySelector('.avatar-lips');\n    const mouthOpening = this.avatarElement?.querySelector('.mouth-opening');\n    if (!lips || !mouthOpening) return;\n    \n    // More realistic mouth movement\n    const scale = 1 + (intensity * 0.8);\n    const mouthScale = 0.5 + (intensity * 1.5);\n    \n    // Animate lips\n    lips.style.transform = `scaleY(${scale})`;\n    \n    // Animate mouth opening\n    mouthOpening.style.transform = `translate(-50%, -50%) scaleY(${mouthScale})`;\n    mouthOpening.style.opacity = Math.min(1, intensity * 2);\n    \n    // Add some randomness for natural movement\n    const randomOffset = (Math.random() - 0.5) * 0.2;\n    lips.style.transform += ` translateY(${randomOffset}px)`;\n  }\n\n  /**\n   * Fallback animation based on text length\n   * @param {string} text - Text to animate for\n   */\n  animateWithText(text) {\n    const duration = Math.max(text.length * 100, 2000); // 100ms per character, min 2s\n    \n    this.animateMouth(0.5); // Medium intensity\n    \n    setTimeout(() => {\n      this.stopSpeaking();\n    }, duration);\n  }\n\n  /**\n   * Stop speaking animation\n   */\n  async stopSpeaking() {\n    this.isAnimating = false;\n    \n    // Remove speaking class\n    if (this.avatarElement) {\n      this.avatarElement.classList.remove('speaking');\n    }\n    \n    if (this.currentAudio) {\n      this.currentAudio.stop();\n      this.currentAudio = null;\n    }\n    \n    if (this.animationFrame) {\n      cancelAnimationFrame(this.animationFrame);\n      this.animationFrame = null;\n    }\n    \n    // Reset mouth to neutral position\n    const lips = this.avatarElement?.querySelector('.avatar-lips');\n    if (lips) {\n      lips.style.transform = 'scaleY(1) translateY(0px)';\n    }\n  }\n\n  /**\n   * Set avatar expression\n   * @param {string} expression - Expression type (happy, serious, thinking, etc.)\n   */\n  setExpression(expression) {\n    if (!this.avatarElement) return;\n    \n    // Remove previous expression classes\n    this.avatarElement.classList.remove('expression-happy', 'expression-serious', 'expression-thinking');\n    \n    // Add new expression class\n    this.avatarElement.classList.add(`expression-${expression}`);\n    \n    // Update visual elements based on expression\n    this.updateExpressionVisuals(expression);\n  }\n\n  /**\n   * Update visual elements for expression\n   * @param {string} expression - Expression type\n   */\n  updateExpressionVisuals(expression) {\n    const eyes = this.avatarElement?.querySelector('.avatar-eyes');\n    const mouth = this.avatarElement?.querySelector('.avatar-mouth');\n    \n    if (!eyes || !mouth) return;\n    \n    switch (expression) {\n      case 'happy':\n        eyes.style.transform = 'scaleY(0.8)';\n        mouth.style.transform = 'scaleY(1.2)';\n        break;\n      case 'serious':\n        eyes.style.transform = 'scaleY(1.2)';\n        mouth.style.transform = 'scaleY(0.8)';\n        break;\n      case 'thinking':\n        eyes.style.transform = 'scaleY(0.6)';\n        mouth.style.transform = 'scaleY(0.9)';\n        break;\n      default:\n        eyes.style.transform = 'scaleY(1)';\n        mouth.style.transform = 'scaleY(1)';\n    }\n  }\n\n  /**\n   * Cleanup resources\n   */\n  destroy() {\n    this.stopSpeaking();\n    \n    if (this.audioContext) {\n      this.audioContext.close();\n      this.audioContext = null;\n    }\n    \n    this.avatarElement = null;\n  }\n}\n\n// Global instance\nexport const avatarService = new AvatarService();\n\n\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAO,MAAMA,aAAa,CAAC;EACzBC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACC,aAAa,GAAG,IAAI;IACzB,IAAI,CAACC,WAAW,GAAG,KAAK;IACxB,IAAI,CAACC,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,QAAQ,GAAG,IAAI;IACpB,IAAI,CAACC,SAAS,GAAG,IAAI;IACrB,IAAI,CAACC,cAAc,GAAG,IAAI;EAC5B;;EAEA;AACF;AACA;AACA;EACEC,UAAUA,CAACP,aAAa,EAAE;IACxB,IAAI,CAACA,aAAa,GAAGA,aAAa;IAClC,IAAI,CAACQ,iBAAiB,CAAC,CAAC;IACxB,IAAI,CAACC,mBAAmB,CAAC,CAAC;EAC5B;;EAEA;AACF;AACA;EACED,iBAAiBA,CAAA,EAAG;IAClB,IAAI;MACF,IAAI,CAACL,YAAY,GAAG,KAAKO,MAAM,CAACC,YAAY,IAAID,MAAM,CAACE,kBAAkB,EAAE,CAAC;MAC5E,IAAI,CAACR,QAAQ,GAAG,IAAI,CAACD,YAAY,CAACU,cAAc,CAAC,CAAC;MAClD,IAAI,CAACT,QAAQ,CAACU,OAAO,GAAG,GAAG;MAC3B,IAAI,CAACT,SAAS,GAAG,IAAIU,UAAU,CAAC,IAAI,CAACX,QAAQ,CAACY,iBAAiB,CAAC;IAClE,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACC,IAAI,CAAC,uDAAuD,CAAC;IACvE;EACF;;EAEF;;EAEE;AACF;AACA;AACA;EACEV,mBAAmBA,CAAA,EAAG;IACpB;IACA,MAAMW,SAAS,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IAC/CF,SAAS,CAACG,SAAS,GAAG,oBAAoB,CAAC,CAAC;;IAE5C;IACAH,SAAS,CAACI,SAAS,GAAG;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;IAED;IACA,IAAI,CAACC,eAAe,CAAC,CAAC;;IAEtB;IACA,OAAOL,SAAS;EAClB;;EAEA;AACF;AACA;EACEK,eAAeA,CAAA,EAAG;IAChB,IAAIJ,QAAQ,CAACK,cAAc,CAAC,eAAe,CAAC,EAAE;IAE9C,MAAMC,KAAK,GAAGN,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;IAC7CK,KAAK,CAACC,EAAE,GAAG,eAAe;IAC1BD,KAAK,CAACE,WAAW,GAAG;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;IAEDR,QAAQ,CAACS,IAAI,CAACC,WAAW,CAACJ,KAAK,CAAC;EAClC;;EAEA;AACF;AACA;AACA;AACA;EACE,MAAMK,aAAaA,CAACC,SAAS,EAAEC,IAAI,GAAG,EAAE,EAAE;IACxC,IAAI,IAAI,CAACjC,WAAW,EAAE;MACpB,MAAM,IAAI,CAACkC,YAAY,CAAC,CAAC;IAC3B;IAEA,IAAI,CAAClC,WAAW,GAAG,IAAI;;IAEvB;IACA,IAAI,IAAI,CAACD,aAAa,EAAE;MACtB,IAAI,CAACA,aAAa,CAACoC,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;IAC9C;IAEA,IAAI;MACF,IAAI,IAAI,CAAClC,YAAY,IAAI8B,SAAS,EAAE;QAClC,MAAM,IAAI,CAACK,oBAAoB,CAACL,SAAS,CAAC;MAC5C,CAAC,MAAM;QACL;QACA,IAAI,CAACM,eAAe,CAACL,IAAI,CAAC;MAC5B;IACF,CAAC,CAAC,OAAOjB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;MAC3D;MACA,IAAI,CAACsB,eAAe,CAACL,IAAI,CAAC;IAC5B;EACF;;EAEA;AACF;AACA;AACA;EACE,MAAMI,oBAAoBA,CAACL,SAAS,EAAE;IACpC,IAAI;MACF,MAAMO,WAAW,GAAG,MAA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}