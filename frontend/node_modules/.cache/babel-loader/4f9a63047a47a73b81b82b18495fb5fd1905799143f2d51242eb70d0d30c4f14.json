{"ast":null,"code":"/**\r\n * Ready Player Me Avatar Service\r\n * Handles 3D avatar integration with lip sync capabilities\r\n */\n\nclass ReadyPlayerMeService {\n  constructor() {\n    this.avatar = null;\n    this.iframe = null;\n    this.isInitialized = false;\n    this.audioContext = null;\n    this.analyser = null;\n    this.isPlaying = false;\n    this.animationFrame = null;\n  }\n\n  /**\r\n   * Initialize Ready Player Me avatar\r\n   * @param {string} containerId - ID of the container element\r\n   * @param {string} avatarUrl - URL of the avatar model\r\n   * @returns {Promise<boolean>} - Success status\r\n   */\n  async initialize(containerId, avatarUrl = 'https://models.readyplayer.me/6544a0e7a2a74c2e557de26a.glb') {\n    try {\n      const container = document.getElementById(containerId);\n      if (!container) {\n        throw new Error(`Container with ID '${containerId}' not found`);\n      }\n\n      // Clear existing content\n      container.innerHTML = '';\n\n      // Create iframe for Ready Player Me\n      this.iframe = document.createElement('iframe');\n      this.iframe.src = `https://readyplayer.me/avatar?frameApi`;\n      this.iframe.style.width = '100%';\n      this.iframe.style.height = '100%';\n      this.iframe.style.border = 'none';\n      this.iframe.style.borderRadius = '12px';\n      container.appendChild(this.iframe);\n\n      // Wait for iframe to load\n      await this.waitForIframeLoad();\n\n      // Load the avatar\n      await this.loadAvatar(avatarUrl);\n\n      // Setup audio context for lip sync\n      this.setupAudioContext();\n      this.isInitialized = true;\n      console.log('Ready Player Me avatar initialized successfully');\n      return true;\n    } catch (error) {\n      console.error('Failed to initialize Ready Player Me avatar:', error);\n      return false;\n    }\n  }\n\n  /**\r\n   * Wait for iframe to load and be ready\r\n   */\n  waitForIframeLoad() {\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        reject(new Error('Iframe load timeout'));\n      }, 10000);\n      this.iframe.onload = () => {\n        clearTimeout(timeout);\n\n        // Wait a bit more for the iframe content to be ready\n        setTimeout(() => {\n          try {\n            // Try to access the iframe's content window\n            const iframeWindow = this.iframe.contentWindow;\n            if (iframeWindow && iframeWindow.ReadyPlayerMe) {\n              resolve();\n            } else {\n              reject(new Error('Ready Player Me API not available'));\n            }\n          } catch (error) {\n            reject(new Error('Cannot access iframe content'));\n          }\n        }, 1000);\n      };\n      this.iframe.onerror = () => {\n        clearTimeout(timeout);\n        reject(new Error('Iframe failed to load'));\n      };\n    });\n  }\n\n  /**\r\n   * Load avatar model\r\n   * @param {string} avatarUrl - URL of the avatar model\r\n   */\n  async loadAvatar(avatarUrl) {\n    return new Promise((resolve, reject) => {\n      try {\n        const iframeWindow = this.iframe.contentWindow;\n        if (iframeWindow && iframeWindow.ReadyPlayerMe) {\n          // Use Ready Player Me API to load avatar\n          iframeWindow.ReadyPlayerMe.loadAvatar(avatarUrl, {\n            useHands: false,\n            useVoice: true,\n            useLipsync: true\n          }).then(avatar => {\n            this.avatar = avatar;\n            console.log('Avatar loaded successfully');\n            resolve();\n          }).catch(error => {\n            console.error('Failed to load avatar:', error);\n            reject(error);\n          });\n        } else {\n          reject(new Error('Ready Player Me API not available'));\n        }\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  /**\r\n   * Setup Web Audio API for lip sync\r\n   */\n  setupAudioContext() {\n    try {\n      this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n      this.analyser = this.audioContext.createAnalyser();\n      this.analyser.fftSize = 256;\n      this.analyser.smoothingTimeConstant = 0.8;\n    } catch (error) {\n      console.warn('Web Audio API not supported:', error);\n    }\n  }\n\n  /**\r\n   * Play audio with lip sync\r\n   * @param {HTMLAudioElement} audioElement - Audio element to play\r\n   * @returns {Promise<void>}\r\n   */\n  async playWithLipSync(audioElement) {\n    if (!this.avatar || !this.audioContext) {\n      console.warn('Avatar or audio context not available for lip sync');\n      return;\n    }\n    try {\n      // Resume audio context if suspended\n      if (this.audioContext.state === 'suspended') {\n        await this.audioContext.resume();\n      }\n\n      // Create audio source from the audio element\n      const source = this.audioContext.createMediaElementSource(audioElement);\n      source.connect(this.analyser);\n      this.analyser.connect(this.audioContext.destination);\n\n      // Start lip sync animation\n      this.startLipSyncAnimation();\n\n      // Play the audio\n      await audioElement.play();\n      this.isPlaying = true;\n\n      // Stop lip sync when audio ends\n      audioElement.onended = () => {\n        this.stopLipSync();\n      };\n    } catch (error) {\n      console.error('Failed to play audio with lip sync:', error);\n      throw error;\n    }\n  }\n\n  /**\r\n   * Start lip sync animation based on audio frequency\r\n   */\n  startLipSyncAnimation() {\n    if (!this.analyser || !this.avatar) return;\n    const dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n    const animate = () => {\n      if (!this.isPlaying) return;\n      this.analyser.getByteFrequencyData(dataArray);\n\n      // Calculate audio intensity\n      const average = dataArray.reduce((a, b) => a + b) / dataArray.length;\n      const max = Math.max(...dataArray);\n      const intensity = Math.min(1, (average + (max - average) * 0.3) / 255);\n\n      // Apply lip sync to avatar\n      this.updateAvatarLipSync(intensity);\n      this.animationFrame = requestAnimationFrame(animate);\n    };\n    animate();\n  }\n\n  /**\r\n   * Update avatar lip sync based on audio intensity\r\n   * @param {number} intensity - Audio intensity (0-1)\r\n   */\n  updateAvatarLipSync(intensity) {\n    if (!this.avatar) return;\n    try {\n      // Map intensity to mouth opening (ARKit blend shapes)\n      const mouthOpen = Math.min(1, intensity * 2);\n      const jawOpen = Math.min(1, intensity * 1.5);\n      const mouthSmile = Math.min(0.3, intensity * 0.5);\n\n      // Apply blend shapes to avatar\n      if (this.avatar.setBlendShape) {\n        this.avatar.setBlendShape('mouthOpen', mouthOpen);\n        this.avatar.setBlendShape('jawOpen', jawOpen);\n        this.avatar.setBlendShape('mouthSmile', mouthSmile);\n      }\n\n      // Alternative method using direct property access\n      if (this.avatar.morphTargets) {\n        this.avatar.morphTargets.mouthOpen = mouthOpen;\n        this.avatar.morphTargets.jawOpen = jawOpen;\n        this.avatar.morphTargets.mouthSmile = mouthSmile;\n      }\n    } catch (error) {\n      console.warn('Failed to update avatar lip sync:', error);\n    }\n  }\n\n  /**\r\n   * Stop lip sync animation\r\n   */\n  stopLipSync() {\n    this.isPlaying = false;\n    if (this.animationFrame) {\n      cancelAnimationFrame(this.animationFrame);\n      this.animationFrame = null;\n    }\n\n    // Reset mouth to neutral position\n    if (this.avatar) {\n      try {\n        if (this.avatar.setBlendShape) {\n          this.avatar.setBlendShape('mouthOpen', 0);\n          this.avatar.setBlendShape('jawOpen', 0);\n          this.avatar.setBlendShape('mouthSmile', 0);\n        }\n      } catch (error) {\n        console.warn('Failed to reset avatar mouth:', error);\n      }\n    }\n  }\n\n  /**\r\n   * Set avatar expression\r\n   * @param {string} expression - Expression type\r\n   */\n  setExpression(expression) {\n    if (!this.avatar) return;\n    try {\n      const expressions = {\n        neutral: {\n          mouthSmile: 0,\n          browDownLeft: 0,\n          browDownRight: 0\n        },\n        happy: {\n          mouthSmile: 0.8,\n          browUpLeft: 0.3,\n          browUpRight: 0.3\n        },\n        serious: {\n          mouthSmile: 0,\n          browDownLeft: 0.5,\n          browDownRight: 0.5\n        },\n        thinking: {\n          mouthSmile: 0.2,\n          browDownLeft: 0.3,\n          browDownRight: 0.3\n        }\n      };\n      const exp = expressions[expression] || expressions.neutral;\n      if (this.avatar.setBlendShape) {\n        Object.entries(exp).forEach(([key, value]) => {\n          this.avatar.setBlendShape(key, value);\n        });\n      }\n    } catch (error) {\n      console.warn('Failed to set avatar expression:', error);\n    }\n  }\n\n  /**\r\n   * Animate avatar (idle animations, gestures, etc.)\r\n   * @param {string} animation - Animation name\r\n   */\n  playAnimation(animation) {\n    if (!this.avatar) return;\n    try {\n      if (this.avatar.playAnimation) {\n        this.avatar.playAnimation(animation);\n      }\n    } catch (error) {\n      console.warn('Failed to play avatar animation:', error);\n    }\n  }\n\n  /**\r\n   * Cleanup resources\r\n   */\n  destroy() {\n    this.stopLipSync();\n    if (this.audioContext) {\n      this.audioContext.close();\n      this.audioContext = null;\n    }\n    if (this.iframe && this.iframe.parentNode) {\n      this.iframe.parentNode.removeChild(this.iframe);\n    }\n    this.avatar = null;\n    this.iframe = null;\n    this.isInitialized = false;\n  }\n\n  /**\r\n   * Check if service is ready\r\n   * @returns {boolean}\r\n   */\n  isReady() {\n    return this.isInitialized && this.avatar !== null;\n  }\n}\n\n// Export singleton instance\nexport const readyPlayerMeService = new ReadyPlayerMeService();\nexport default readyPlayerMeService;","map":{"version":3,"names":["ReadyPlayerMeService","constructor","avatar","iframe","isInitialized","audioContext","analyser","isPlaying","animationFrame","initialize","containerId","avatarUrl","container","document","getElementById","Error","innerHTML","createElement","src","style","width","height","border","borderRadius","appendChild","waitForIframeLoad","loadAvatar","setupAudioContext","console","log","error","Promise","resolve","reject","timeout","setTimeout","onload","clearTimeout","iframeWindow","contentWindow","ReadyPlayerMe","onerror","useHands","useVoice","useLipsync","then","catch","window","AudioContext","webkitAudioContext","createAnalyser","fftSize","smoothingTimeConstant","warn","playWithLipSync","audioElement","state","resume","source","createMediaElementSource","connect","destination","startLipSyncAnimation","play","onended","stopLipSync","dataArray","Uint8Array","frequencyBinCount","animate","getByteFrequencyData","average","reduce","a","b","length","max","Math","intensity","min","updateAvatarLipSync","requestAnimationFrame","mouthOpen","jawOpen","mouthSmile","setBlendShape","morphTargets","cancelAnimationFrame","setExpression","expression","expressions","neutral","browDownLeft","browDownRight","happy","browUpLeft","browUpRight","serious","thinking","exp","Object","entries","forEach","key","value","playAnimation","animation","destroy","close","parentNode","removeChild","isReady","readyPlayerMeService"],"sources":["D:/ai_avatar/frontend/src/services/readyPlayerMeService.js"],"sourcesContent":["/**\r\n * Ready Player Me Avatar Service\r\n * Handles 3D avatar integration with lip sync capabilities\r\n */\r\n\r\nclass ReadyPlayerMeService {\r\n  constructor() {\r\n    this.avatar = null;\r\n    this.iframe = null;\r\n    this.isInitialized = false;\r\n    this.audioContext = null;\r\n    this.analyser = null;\r\n    this.isPlaying = false;\r\n    this.animationFrame = null;\r\n  }\r\n\r\n  /**\r\n   * Initialize Ready Player Me avatar\r\n   * @param {string} containerId - ID of the container element\r\n   * @param {string} avatarUrl - URL of the avatar model\r\n   * @returns {Promise<boolean>} - Success status\r\n   */\r\n  async initialize(containerId, avatarUrl = 'https://models.readyplayer.me/6544a0e7a2a74c2e557de26a.glb') {\r\n    try {\r\n      const container = document.getElementById(containerId);\r\n      if (!container) {\r\n        throw new Error(`Container with ID '${containerId}' not found`);\r\n      }\r\n\r\n      // Clear existing content\r\n      container.innerHTML = '';\r\n\r\n      // Create iframe for Ready Player Me\r\n      this.iframe = document.createElement('iframe');\r\n      this.iframe.src = `https://readyplayer.me/avatar?frameApi`;\r\n      this.iframe.style.width = '100%';\r\n      this.iframe.style.height = '100%';\r\n      this.iframe.style.border = 'none';\r\n      this.iframe.style.borderRadius = '12px';\r\n      \r\n      container.appendChild(this.iframe);\r\n\r\n      // Wait for iframe to load\r\n      await this.waitForIframeLoad();\r\n\r\n      // Load the avatar\r\n      await this.loadAvatar(avatarUrl);\r\n\r\n      // Setup audio context for lip sync\r\n      this.setupAudioContext();\r\n\r\n      this.isInitialized = true;\r\n      console.log('Ready Player Me avatar initialized successfully');\r\n      return true;\r\n\r\n    } catch (error) {\r\n      console.error('Failed to initialize Ready Player Me avatar:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Wait for iframe to load and be ready\r\n   */\r\n  waitForIframeLoad() {\r\n    return new Promise((resolve, reject) => {\r\n      const timeout = setTimeout(() => {\r\n        reject(new Error('Iframe load timeout'));\r\n      }, 10000);\r\n\r\n      this.iframe.onload = () => {\r\n        clearTimeout(timeout);\r\n        \r\n        // Wait a bit more for the iframe content to be ready\r\n        setTimeout(() => {\r\n          try {\r\n            // Try to access the iframe's content window\r\n            const iframeWindow = this.iframe.contentWindow;\r\n            if (iframeWindow && iframeWindow.ReadyPlayerMe) {\r\n              resolve();\r\n            } else {\r\n              reject(new Error('Ready Player Me API not available'));\r\n            }\r\n          } catch (error) {\r\n            reject(new Error('Cannot access iframe content'));\r\n          }\r\n        }, 1000);\r\n      };\r\n\r\n      this.iframe.onerror = () => {\r\n        clearTimeout(timeout);\r\n        reject(new Error('Iframe failed to load'));\r\n      };\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Load avatar model\r\n   * @param {string} avatarUrl - URL of the avatar model\r\n   */\r\n  async loadAvatar(avatarUrl) {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        const iframeWindow = this.iframe.contentWindow;\r\n        \r\n        if (iframeWindow && iframeWindow.ReadyPlayerMe) {\r\n          // Use Ready Player Me API to load avatar\r\n          iframeWindow.ReadyPlayerMe.loadAvatar(avatarUrl, {\r\n            useHands: false,\r\n            useVoice: true,\r\n            useLipsync: true\r\n          }).then((avatar) => {\r\n            this.avatar = avatar;\r\n            console.log('Avatar loaded successfully');\r\n            resolve();\r\n          }).catch((error) => {\r\n            console.error('Failed to load avatar:', error);\r\n            reject(error);\r\n          });\r\n        } else {\r\n          reject(new Error('Ready Player Me API not available'));\r\n        }\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Setup Web Audio API for lip sync\r\n   */\r\n  setupAudioContext() {\r\n    try {\r\n      this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\r\n      this.analyser = this.audioContext.createAnalyser();\r\n      this.analyser.fftSize = 256;\r\n      this.analyser.smoothingTimeConstant = 0.8;\r\n    } catch (error) {\r\n      console.warn('Web Audio API not supported:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Play audio with lip sync\r\n   * @param {HTMLAudioElement} audioElement - Audio element to play\r\n   * @returns {Promise<void>}\r\n   */\r\n  async playWithLipSync(audioElement) {\r\n    if (!this.avatar || !this.audioContext) {\r\n      console.warn('Avatar or audio context not available for lip sync');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Resume audio context if suspended\r\n      if (this.audioContext.state === 'suspended') {\r\n        await this.audioContext.resume();\r\n      }\r\n\r\n      // Create audio source from the audio element\r\n      const source = this.audioContext.createMediaElementSource(audioElement);\r\n      source.connect(this.analyser);\r\n      this.analyser.connect(this.audioContext.destination);\r\n\r\n      // Start lip sync animation\r\n      this.startLipSyncAnimation();\r\n\r\n      // Play the audio\r\n      await audioElement.play();\r\n      this.isPlaying = true;\r\n\r\n      // Stop lip sync when audio ends\r\n      audioElement.onended = () => {\r\n        this.stopLipSync();\r\n      };\r\n\r\n    } catch (error) {\r\n      console.error('Failed to play audio with lip sync:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Start lip sync animation based on audio frequency\r\n   */\r\n  startLipSyncAnimation() {\r\n    if (!this.analyser || !this.avatar) return;\r\n\r\n    const dataArray = new Uint8Array(this.analyser.frequencyBinCount);\r\n\r\n    const animate = () => {\r\n      if (!this.isPlaying) return;\r\n\r\n      this.analyser.getByteFrequencyData(dataArray);\r\n      \r\n      // Calculate audio intensity\r\n      const average = dataArray.reduce((a, b) => a + b) / dataArray.length;\r\n      const max = Math.max(...dataArray);\r\n      const intensity = Math.min(1, (average + (max - average) * 0.3) / 255);\r\n\r\n      // Apply lip sync to avatar\r\n      this.updateAvatarLipSync(intensity);\r\n\r\n      this.animationFrame = requestAnimationFrame(animate);\r\n    };\r\n\r\n    animate();\r\n  }\r\n\r\n  /**\r\n   * Update avatar lip sync based on audio intensity\r\n   * @param {number} intensity - Audio intensity (0-1)\r\n   */\r\n  updateAvatarLipSync(intensity) {\r\n    if (!this.avatar) return;\r\n\r\n    try {\r\n      // Map intensity to mouth opening (ARKit blend shapes)\r\n      const mouthOpen = Math.min(1, intensity * 2);\r\n      const jawOpen = Math.min(1, intensity * 1.5);\r\n      const mouthSmile = Math.min(0.3, intensity * 0.5);\r\n\r\n      // Apply blend shapes to avatar\r\n      if (this.avatar.setBlendShape) {\r\n        this.avatar.setBlendShape('mouthOpen', mouthOpen);\r\n        this.avatar.setBlendShape('jawOpen', jawOpen);\r\n        this.avatar.setBlendShape('mouthSmile', mouthSmile);\r\n      }\r\n\r\n      // Alternative method using direct property access\r\n      if (this.avatar.morphTargets) {\r\n        this.avatar.morphTargets.mouthOpen = mouthOpen;\r\n        this.avatar.morphTargets.jawOpen = jawOpen;\r\n        this.avatar.morphTargets.mouthSmile = mouthSmile;\r\n      }\r\n\r\n    } catch (error) {\r\n      console.warn('Failed to update avatar lip sync:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Stop lip sync animation\r\n   */\r\n  stopLipSync() {\r\n    this.isPlaying = false;\r\n    \r\n    if (this.animationFrame) {\r\n      cancelAnimationFrame(this.animationFrame);\r\n      this.animationFrame = null;\r\n    }\r\n\r\n    // Reset mouth to neutral position\r\n    if (this.avatar) {\r\n      try {\r\n        if (this.avatar.setBlendShape) {\r\n          this.avatar.setBlendShape('mouthOpen', 0);\r\n          this.avatar.setBlendShape('jawOpen', 0);\r\n          this.avatar.setBlendShape('mouthSmile', 0);\r\n        }\r\n      } catch (error) {\r\n        console.warn('Failed to reset avatar mouth:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set avatar expression\r\n   * @param {string} expression - Expression type\r\n   */\r\n  setExpression(expression) {\r\n    if (!this.avatar) return;\r\n\r\n    try {\r\n      const expressions = {\r\n        neutral: { mouthSmile: 0, browDownLeft: 0, browDownRight: 0 },\r\n        happy: { mouthSmile: 0.8, browUpLeft: 0.3, browUpRight: 0.3 },\r\n        serious: { mouthSmile: 0, browDownLeft: 0.5, browDownRight: 0.5 },\r\n        thinking: { mouthSmile: 0.2, browDownLeft: 0.3, browDownRight: 0.3 }\r\n      };\r\n\r\n      const exp = expressions[expression] || expressions.neutral;\r\n\r\n      if (this.avatar.setBlendShape) {\r\n        Object.entries(exp).forEach(([key, value]) => {\r\n          this.avatar.setBlendShape(key, value);\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to set avatar expression:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Animate avatar (idle animations, gestures, etc.)\r\n   * @param {string} animation - Animation name\r\n   */\r\n  playAnimation(animation) {\r\n    if (!this.avatar) return;\r\n\r\n    try {\r\n      if (this.avatar.playAnimation) {\r\n        this.avatar.playAnimation(animation);\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to play avatar animation:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cleanup resources\r\n   */\r\n  destroy() {\r\n    this.stopLipSync();\r\n\r\n    if (this.audioContext) {\r\n      this.audioContext.close();\r\n      this.audioContext = null;\r\n    }\r\n\r\n    if (this.iframe && this.iframe.parentNode) {\r\n      this.iframe.parentNode.removeChild(this.iframe);\r\n    }\r\n\r\n    this.avatar = null;\r\n    this.iframe = null;\r\n    this.isInitialized = false;\r\n  }\r\n\r\n  /**\r\n   * Check if service is ready\r\n   * @returns {boolean}\r\n   */\r\n  isReady() {\r\n    return this.isInitialized && this.avatar !== null;\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const readyPlayerMeService = new ReadyPlayerMeService();\r\nexport default readyPlayerMeService;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}