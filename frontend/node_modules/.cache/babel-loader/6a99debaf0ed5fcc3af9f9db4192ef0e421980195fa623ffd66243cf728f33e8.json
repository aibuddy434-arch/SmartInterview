{"ast":null,"code":"/**\n * Utility functions for consistent error handling across the application\n */\n\n/**\n * Safely extracts error message from various error response formats\n * @param {Error} error - The error object from try/catch\n * @param {string} fallbackMessage - Default message if no error details found\n * @returns {string} - Safe error message to display to user\n */\n/**\n * Utility functions for consistent error handling across the application\n */\n\n// Extract error message safely\n\nexport const getErrorMessage = (error, fallbackMessage = 'An unexpected error occurred') => {\n  var _error$response;\n  if (!error) return fallbackMessage;\n  if ((_error$response = error.response) !== null && _error$response !== void 0 && _error$response.data) {\n    const data = error.response.data;\n    if (data.detail) return data.detail;\n    if (data.error) return data.error;\n    if (data.errors && Array.isArray(data.errors)) {\n      return data.errors.join(', ');\n    }\n    if (data.message) return data.message;\n  }\n  if (error.message) return error.message;\n  if (error.error) return error.error;\n  return fallbackMessage;\n};\n\n// Validate required fields inside response\nexport const validateResponse = (response, requiredFields = [], fallbackMessage = 'Invalid response from server') => {\n  if (!response || typeof response !== 'object') {\n    return {\n      success: false,\n      data: null,\n      error: fallbackMessage\n    };\n  }\n  const isValid = requiredFields.every(field => {\n    const fieldPath = field.split('.');\n    let current = response;\n    for (const key of fieldPath) {\n      if (current && typeof current === 'object' && key in current) {\n        current = current[key];\n      } else {\n        return false;\n      }\n    }\n    return current !== null && current !== undefined;\n  });\n  if (isValid) {\n    return {\n      success: true,\n      data: response,\n      error: null\n    };\n  } else {\n    return {\n      success: false,\n      data: null,\n      error: fallbackMessage\n    };\n  }\n};\n\n// Handle raw responses safely\nexport const safeResponseHandler = (response, requiredFields = [], errorMessage = 'Invalid response from server') => {\n  const validationResult = validateResponse(response, requiredFields, errorMessage);\n  if (validationResult.success) {\n    return validationResult;\n  } else {\n    console.error('Response validation failed:', response);\n    return validationResult;\n  }\n};\n\n// API call wrapper without validation\nexport const safeApiCall = async (apiCall, fallbackMessage = 'API call failed') => {\n  try {\n    const response = await apiCall();\n\n    // Handle standardized backend response structure\n    if (response && response.data) {\n      const {\n        success,\n        data,\n        message,\n        error\n      } = response.data;\n      if (success === true) {\n        return {\n          success: true,\n          data: data || null,\n          error: null\n        };\n      } else {\n        return {\n          success: false,\n          data: null,\n          error: error || message || fallbackMessage\n        };\n      }\n    }\n\n    // Handle direct response data (no wrapper)\n    if (response && typeof response === 'object') {\n      return {\n        success: true,\n        data: response,\n        error: null\n      };\n    }\n\n    // Fallback for non-standardized responses (assume success)\n    return {\n      success: true,\n      data: response || null,\n      error: null\n    };\n  } catch (error) {\n    const errorMessage = getErrorMessage(error, fallbackMessage);\n    console.error('API call failed:', error);\n    return {\n      success: false,\n      data: null,\n      error: errorMessage\n    };\n  }\n};\n\n// API call wrapper WITH validation\nexport const safeApiCallWithValidation = async (apiCall, requiredFields = [], fallbackMessage = 'Request failed') => {\n  try {\n    const response = await apiCall();\n\n    // Handle standardized backend response structure\n    if (response && response.data) {\n      const {\n        success,\n        data,\n        message,\n        error\n      } = response.data;\n      if (success === true) {\n        // Validate required fields in the data\n        const validationResult = validateResponse(data, requiredFields, fallbackMessage);\n        if (validationResult.success) {\n          return {\n            success: true,\n            data: data || null,\n            error: null\n          };\n        } else {\n          return validationResult;\n        }\n      } else {\n        return {\n          success: false,\n          data: null,\n          error: error || message || fallbackMessage\n        };\n      }\n    }\n\n    // Handle direct response data (no wrapper)\n    if (response && typeof response === 'object') {\n      const validationResult = validateResponse(response, requiredFields, fallbackMessage);\n      return validationResult;\n    }\n\n    // Fallback for non-standardized responses\n    return safeResponseHandler(response, requiredFields, fallbackMessage);\n  } catch (error) {\n    const errorMessage = getErrorMessage(error, fallbackMessage);\n    console.error('API call failed:', error);\n    return {\n      success: false,\n      data: null,\n      error: errorMessage\n    };\n  }\n};","map":{"version":3,"names":["getErrorMessage","error","fallbackMessage","_error$response","response","data","detail","errors","Array","isArray","join","message","validateResponse","requiredFields","success","isValid","every","field","fieldPath","split","current","key","undefined","safeResponseHandler","errorMessage","validationResult","console","safeApiCall","apiCall","safeApiCallWithValidation"],"sources":["D:/ai_avatar/frontend/src/utils/errorHandler.js"],"sourcesContent":["/**\n * Utility functions for consistent error handling across the application\n */\n\n/**\n * Safely extracts error message from various error response formats\n * @param {Error} error - The error object from try/catch\n * @param {string} fallbackMessage - Default message if no error details found\n * @returns {string} - Safe error message to display to user\n */\n/**\n * Utility functions for consistent error handling across the application\n */\n\n// Extract error message safely\n\n\n\n\nexport const getErrorMessage = (error, fallbackMessage = 'An unexpected error occurred') => {\n  if (!error) return fallbackMessage;\n\n  if (error.response?.data) {\n    const data = error.response.data;\n    if (data.detail) return data.detail;\n    if (data.error) return data.error;\n    if (data.errors && Array.isArray(data.errors)) {\n      return data.errors.join(', ');\n    }\n    if (data.message) return data.message;\n  }\n\n  if (error.message) return error.message;\n  if (error.error) return error.error;\n\n  return fallbackMessage;\n};\n\n// Validate required fields inside response\nexport const validateResponse = (response, requiredFields = [], fallbackMessage = 'Invalid response from server') => {\n  if (!response || typeof response !== 'object') {\n    return { success: false, data: null, error: fallbackMessage };\n  }\n\n  const isValid = requiredFields.every(field => {\n    const fieldPath = field.split('.');\n    let current = response;\n\n    for (const key of fieldPath) {\n      if (current && typeof current === 'object' && key in current) {\n        current = current[key];\n      } else {\n        return false;\n      }\n    }\n    return current !== null && current !== undefined;\n  });\n\n  if (isValid) {\n    return { success: true, data: response, error: null };\n  } else {\n    return { success: false, data: null, error: fallbackMessage };\n  }\n};\n\n// Handle raw responses safely\nexport const safeResponseHandler = (response, requiredFields = [], errorMessage = 'Invalid response from server') => {\n  const validationResult = validateResponse(response, requiredFields, errorMessage);\n  if (validationResult.success) {\n    return validationResult;\n  } else {\n    console.error('Response validation failed:', response);\n    return validationResult;\n  }\n};\n\n// API call wrapper without validation\nexport const safeApiCall = async (apiCall, fallbackMessage = 'API call failed') => {\n  try {\n    const response = await apiCall();\n\n    // Handle standardized backend response structure\n    if (response && response.data) {\n      const { success, data, message, error } = response.data;\n      \n      if (success === true) {\n        return { success: true, data: data || null, error: null };\n      } else {\n        return { success: false, data: null, error: error || message || fallbackMessage };\n      }\n    }\n    \n    // Handle direct response data (no wrapper)\n    if (response && typeof response === 'object') {\n      return { success: true, data: response, error: null };\n    }\n    \n    // Fallback for non-standardized responses (assume success)\n    return { success: true, data: response || null, error: null };\n  } catch (error) {\n    const errorMessage = getErrorMessage(error, fallbackMessage);\n    console.error('API call failed:', error);\n    return { success: false, data: null, error: errorMessage };\n  }\n};\n\n// API call wrapper WITH validation\nexport const safeApiCallWithValidation = async (apiCall, requiredFields = [], fallbackMessage = 'Request failed') => {\n  try {\n    const response = await apiCall();\n\n    // Handle standardized backend response structure\n    if (response && response.data) {\n      const { success, data, message, error } = response.data;\n      \n      if (success === true) {\n        // Validate required fields in the data\n        const validationResult = validateResponse(data, requiredFields, fallbackMessage);\n        if (validationResult.success) {\n          return { success: true, data: data || null, error: null };\n        } else {\n          return validationResult;\n        }\n      } else {\n        return { success: false, data: null, error: error || message || fallbackMessage };\n      }\n    }\n    \n    // Handle direct response data (no wrapper)\n    if (response && typeof response === 'object') {\n      const validationResult = validateResponse(response, requiredFields, fallbackMessage);\n      return validationResult;\n    }\n    \n    // Fallback for non-standardized responses\n    return safeResponseHandler(response, requiredFields, fallbackMessage);\n  } catch (error) {\n    const errorMessage = getErrorMessage(error, fallbackMessage);\n    console.error('API call failed:', error);\n    return { success: false, data: null, error: errorMessage };\n  }\n};\n\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}