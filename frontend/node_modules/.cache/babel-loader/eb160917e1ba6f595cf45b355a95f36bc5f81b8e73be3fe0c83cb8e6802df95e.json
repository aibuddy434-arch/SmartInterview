{"ast":null,"code":"/**\r\n * Utility functions for consistent error handling across the application\r\n */\n\n/**\r\n * Safely extracts error message from various error response formats\r\n * @param {Error} error - The error object from try/catch\r\n * @param {string} fallbackMessage - Default message if no error details found\r\n * @returns {string} - Safe error message to display to user\r\n */\nexport const getErrorMessage = (error, fallbackMessage = 'An unexpected error occurred') => {\n  var _error$response;\n  if (!error) return fallbackMessage;\n\n  // Check for Axios response error\n  if ((_error$response = error.response) !== null && _error$response !== void 0 && _error$response.data) {\n    const data = error.response.data;\n\n    // FastAPI error format: { \"detail\": \"...\" }\n    if (data.detail) return data.detail;\n\n    // Custom error format: { \"error\": \"...\" }\n    if (data.error) return data.error;\n\n    // Multiple errors format: { \"errors\": [...] }\n    if (data.errors && Array.isArray(data.errors)) {\n      return data.errors.join(', ');\n    }\n\n    // Message format: { \"message\": \"...\" }\n    if (data.message) return data.message;\n  }\n\n  // Check for network error\n  if (error.message) return error.message;\n\n  // Check for custom error properties\n  if (error.error) return error.error;\n  return fallbackMessage;\n};\n\n/**\r\n * Safely checks if a response object has the expected structure\r\n * @param {any} response - The response object to validate\r\n * @param {string[]} requiredFields - Array of required field paths (e.g., ['candidate.id', 'session_id'])\r\n * @returns {boolean} - True if response has all required fields\r\n */\nexport const validateResponse = (response, requiredFields = []) => {\n  if (!response || typeof response !== 'object') return false;\n  return requiredFields.every(field => {\n    const fieldPath = field.split('.');\n    let current = response;\n    for (const key of fieldPath) {\n      if (current && typeof current === 'object' && key in current) {\n        current = current[key];\n      } else {\n        return false;\n      }\n    }\n    return current !== null && current !== undefined;\n  });\n};\n\n/**\r\n * Safely extracts data from response with validation\r\n * @param {any} response - The response object\r\n * @param {string[]} requiredFields - Array of required field paths\r\n * @param {string} errorMessage - Error message if validation fails\r\n * @returns {Object} - { success: boolean, data: any, error: string }\r\n */\nexport const safeResponseHandler = (response, requiredFields = [], errorMessage = 'Invalid response from server') => {\n  if (validateResponse(response, requiredFields)) {\n    return {\n      success: true,\n      data: response\n    };\n  } else {\n    console.error('Response validation failed:', response);\n    return {\n      success: false,\n      data: null,\n      error: errorMessage\n    };\n  }\n};\n\n/**\r\n * Wrapper for API calls with consistent error handling\r\n * @param {Function} apiCall - The API function to call\r\n * @param {string} fallbackMessage - Default error message\r\n * @returns {Promise<Object>} - { success: boolean, data: any, error: string }\r\n */\nexport const safeApiCall = async (apiCall, fallbackMessage = 'API call failed') => {\n  try {\n    const response = await apiCall();\n\n    // Handle standardized backend response structure\n    if (response && response.data) {\n      const {\n        success,\n        data,\n        message,\n        error\n      } = response.data;\n      if (success === true) {\n        return {\n          success: true,\n          data: data,\n          error: null\n        };\n      } else {\n        return {\n          success: false,\n          data: null,\n          error: error || message || fallbackMessage\n        };\n      }\n    }\n\n    // Fallback for non-standardized responses\n    return {\n      success: true,\n      data: response,\n      error: null\n    };\n  } catch (error) {\n    const errorMessage = getErrorMessage(error, fallbackMessage);\n    console.error('API call failed:', error);\n    return {\n      success: false,\n      data: null,\n      error: errorMessage\n    };\n  }\n};\n\n/**\r\n * Wrapper for API calls with response validation\r\n * @param {Function} apiCall - The API function to call\r\n * @param {string[]} requiredFields - Array of required field paths\r\n * @param {string} fallbackMessage - Default error message\r\n * @returns {Promise<Object>} - { success: boolean, data: any, error: string }\r\n */\nexport const safeApiCallWithValidation = async (apiCall, requiredFields = [], fallbackMessage = 'API call failed') => {\n  try {\n    const response = await apiCall();\n\n    // Handle standardized backend response structure\n    if (response && response.data) {\n      const {\n        success,\n        data,\n        message,\n        error\n      } = response.data;\n      if (success === true) {\n        // Validate required fields in the data\n        const validationResult = validateResponse(data, requiredFields, fallbackMessage);\n        if (validationResult.success) {\n          return {\n            success: true,\n            data: data,\n            error: null\n          };\n        } else {\n          return validationResult;\n        }\n      } else {\n        return {\n          success: false,\n          data: null,\n          error: error || message || fallbackMessage\n        };\n      }\n    }\n\n    // Fallback for non-standardized responses\n    return safeResponseHandler(response, requiredFields, fallbackMessage);\n  } catch (error) {\n    const errorMessage = getErrorMessage(error, fallbackMessage);\n    console.error('API call failed:', error);\n    return {\n      success: false,\n      data: null,\n      error: errorMessage\n    };\n  }\n};","map":{"version":3,"names":["getErrorMessage","error","fallbackMessage","_error$response","response","data","detail","errors","Array","isArray","join","message","validateResponse","requiredFields","every","field","fieldPath","split","current","key","undefined","safeResponseHandler","errorMessage","success","console","safeApiCall","apiCall","safeApiCallWithValidation","validationResult"],"sources":["D:/ai_avatar/frontend/src/utils/errorHandler.js"],"sourcesContent":["/**\r\n * Utility functions for consistent error handling across the application\r\n */\r\n\r\n/**\r\n * Safely extracts error message from various error response formats\r\n * @param {Error} error - The error object from try/catch\r\n * @param {string} fallbackMessage - Default message if no error details found\r\n * @returns {string} - Safe error message to display to user\r\n */\r\nexport const getErrorMessage = (error, fallbackMessage = 'An unexpected error occurred') => {\r\n  if (!error) return fallbackMessage;\r\n  \r\n  // Check for Axios response error\r\n  if (error.response?.data) {\r\n    const data = error.response.data;\r\n    \r\n    // FastAPI error format: { \"detail\": \"...\" }\r\n    if (data.detail) return data.detail;\r\n    \r\n    // Custom error format: { \"error\": \"...\" }\r\n    if (data.error) return data.error;\r\n    \r\n    // Multiple errors format: { \"errors\": [...] }\r\n    if (data.errors && Array.isArray(data.errors)) {\r\n      return data.errors.join(', ');\r\n    }\r\n    \r\n    // Message format: { \"message\": \"...\" }\r\n    if (data.message) return data.message;\r\n  }\r\n  \r\n  // Check for network error\r\n  if (error.message) return error.message;\r\n  \r\n  // Check for custom error properties\r\n  if (error.error) return error.error;\r\n  \r\n  return fallbackMessage;\r\n};\r\n\r\n/**\r\n * Safely checks if a response object has the expected structure\r\n * @param {any} response - The response object to validate\r\n * @param {string[]} requiredFields - Array of required field paths (e.g., ['candidate.id', 'session_id'])\r\n * @returns {boolean} - True if response has all required fields\r\n */\r\nexport const validateResponse = (response, requiredFields = []) => {\r\n  if (!response || typeof response !== 'object') return false;\r\n  \r\n  return requiredFields.every(field => {\r\n    const fieldPath = field.split('.');\r\n    let current = response;\r\n    \r\n    for (const key of fieldPath) {\r\n      if (current && typeof current === 'object' && key in current) {\r\n        current = current[key];\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n    \r\n    return current !== null && current !== undefined;\r\n  });\r\n};\r\n\r\n/**\r\n * Safely extracts data from response with validation\r\n * @param {any} response - The response object\r\n * @param {string[]} requiredFields - Array of required field paths\r\n * @param {string} errorMessage - Error message if validation fails\r\n * @returns {Object} - { success: boolean, data: any, error: string }\r\n */\r\nexport const safeResponseHandler = (response, requiredFields = [], errorMessage = 'Invalid response from server') => {\r\n  if (validateResponse(response, requiredFields)) {\r\n    return { success: true, data: response };\r\n  } else {\r\n    console.error('Response validation failed:', response);\r\n    return { success: false, data: null, error: errorMessage };\r\n  }\r\n};\r\n\r\n/**\r\n * Wrapper for API calls with consistent error handling\r\n * @param {Function} apiCall - The API function to call\r\n * @param {string} fallbackMessage - Default error message\r\n * @returns {Promise<Object>} - { success: boolean, data: any, error: string }\r\n */\r\nexport const safeApiCall = async (apiCall, fallbackMessage = 'API call failed') => {\r\n  try {\r\n    const response = await apiCall();\r\n    \r\n    // Handle standardized backend response structure\r\n    if (response && response.data) {\r\n      const { success, data, message, error } = response.data;\r\n      \r\n      if (success === true) {\r\n        return { success: true, data: data, error: null };\r\n      } else {\r\n        return { success: false, data: null, error: error || message || fallbackMessage };\r\n      }\r\n    }\r\n    \r\n    // Fallback for non-standardized responses\r\n    return { success: true, data: response, error: null };\r\n  } catch (error) {\r\n    const errorMessage = getErrorMessage(error, fallbackMessage);\r\n    console.error('API call failed:', error);\r\n    return { success: false, data: null, error: errorMessage };\r\n  }\r\n};\r\n\r\n/**\r\n * Wrapper for API calls with response validation\r\n * @param {Function} apiCall - The API function to call\r\n * @param {string[]} requiredFields - Array of required field paths\r\n * @param {string} fallbackMessage - Default error message\r\n * @returns {Promise<Object>} - { success: boolean, data: any, error: string }\r\n */\r\nexport const safeApiCallWithValidation = async (apiCall, requiredFields = [], fallbackMessage = 'API call failed') => {\r\n  try {\r\n    const response = await apiCall();\r\n    \r\n    // Handle standardized backend response structure\r\n    if (response && response.data) {\r\n      const { success, data, message, error } = response.data;\r\n      \r\n      if (success === true) {\r\n        // Validate required fields in the data\r\n        const validationResult = validateResponse(data, requiredFields, fallbackMessage);\r\n        if (validationResult.success) {\r\n          return { success: true, data: data, error: null };\r\n        } else {\r\n          return validationResult;\r\n        }\r\n      } else {\r\n        return { success: false, data: null, error: error || message || fallbackMessage };\r\n      }\r\n    }\r\n    \r\n    // Fallback for non-standardized responses\r\n    return safeResponseHandler(response, requiredFields, fallbackMessage);\r\n  } catch (error) {\r\n    const errorMessage = getErrorMessage(error, fallbackMessage);\r\n    console.error('API call failed:', error);\r\n    return { success: false, data: null, error: errorMessage };\r\n  }\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}