{"ast":null,"code":"/**\r\n * Utility functions for consistent error handling across the application\r\n *//**\r\n * Safely extracts error message from various error response formats\r\n * @param {Error} error - The error object from try/catch\r\n * @param {string} fallbackMessage - Default message if no error details found\r\n * @returns {string} - Safe error message to display to user\r\n *//**\r\n * Utility functions for consistent error handling across the application\r\n */// Extract error message safely\nexport const getErrorMessage=function(error){var _error$response;let fallbackMessage=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'An unexpected error occurred';if(!error)return fallbackMessage;if((_error$response=error.response)!==null&&_error$response!==void 0&&_error$response.data){const data=error.response.data;if(data.detail)return data.detail;if(data.error)return data.error;if(data.errors&&Array.isArray(data.errors)){return data.errors.join(', ');}if(data.message)return data.message;}if(error.message)return error.message;if(error.error)return error.error;return fallbackMessage;};// Validate required fields inside response\nexport const validateResponse=function(response){let requiredFields=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let fallbackMessage=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'Invalid response from server';if(!response||typeof response!=='object'){return{success:false,data:null,error:fallbackMessage};}const isValid=requiredFields.every(field=>{const fieldPath=field.split('.');let current=response;for(const key of fieldPath){if(current&&typeof current==='object'&&key in current){current=current[key];}else{return false;}}return current!==null&&current!==undefined;});if(isValid){return{success:true,data:response,error:null};}else{return{success:false,data:null,error:fallbackMessage};}};// Handle raw responses safely\nexport const safeResponseHandler=function(response){let requiredFields=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let errorMessage=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'Invalid response from server';const validationResult=validateResponse(response,requiredFields,errorMessage);if(validationResult.success){return validationResult;}else{console.error('Response validation failed:',response);return validationResult;}};// API call wrapper without validation\nexport const safeApiCall=async function(apiCall){let fallbackMessage=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'API call failed';try{const response=await apiCall();// Handle standardized backend response structure\nif(response&&response.data){const{success,data,message,error}=response.data;if(success===true){return{success:true,data:data,error:null};}else{return{success:false,data:null,error:error||message||fallbackMessage};}}// Fallback for non-standardized responses (assume success)\nreturn{success:true,data:response,error:null};}catch(error){const errorMessage=getErrorMessage(error,fallbackMessage);console.error('API call failed:',error);return{success:false,data:null,error:errorMessage};}};// API call wrapper WITH validation\nexport const safeApiCallWithValidation=async function(apiCall){let requiredFields=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let fallbackMessage=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'Request failed';try{const response=await apiCall();// Handle standardized backend response structure\nif(response&&response.data){const{success,data,message,error}=response.data;if(success===true){// Validate required fields in the data\nconst validationResult=validateResponse(data,requiredFields,fallbackMessage);if(validationResult.success){return{success:true,data:data,error:null};}else{return validationResult;}}else{return{success:false,data:null,error:error||message||fallbackMessage};}}// Fallback for non-standardized responses\nreturn safeResponseHandler(response,requiredFields,fallbackMessage);}catch(error){const errorMessage=getErrorMessage(error,fallbackMessage);console.error('API call failed:',error);return{success:false,data:null,error:errorMessage};}};","map":{"version":3,"names":["getErrorMessage","error","_error$response","fallbackMessage","arguments","length","undefined","response","data","detail","errors","Array","isArray","join","message","validateResponse","requiredFields","success","isValid","every","field","fieldPath","split","current","key","safeResponseHandler","errorMessage","validationResult","console","safeApiCall","apiCall","safeApiCallWithValidation"],"sources":["D:/ai_avatar/frontend/src/utils/errorHandler.js"],"sourcesContent":["/**\r\n * Utility functions for consistent error handling across the application\r\n */\r\n\r\n/**\r\n * Safely extracts error message from various error response formats\r\n * @param {Error} error - The error object from try/catch\r\n * @param {string} fallbackMessage - Default message if no error details found\r\n * @returns {string} - Safe error message to display to user\r\n */\r\n/**\r\n * Utility functions for consistent error handling across the application\r\n */\r\n\r\n// Extract error message safely\r\nexport const getErrorMessage = (error, fallbackMessage = 'An unexpected error occurred') => {\r\n  if (!error) return fallbackMessage;\r\n\r\n  if (error.response?.data) {\r\n    const data = error.response.data;\r\n    if (data.detail) return data.detail;\r\n    if (data.error) return data.error;\r\n    if (data.errors && Array.isArray(data.errors)) {\r\n      return data.errors.join(', ');\r\n    }\r\n    if (data.message) return data.message;\r\n  }\r\n\r\n  if (error.message) return error.message;\r\n  if (error.error) return error.error;\r\n\r\n  return fallbackMessage;\r\n};\r\n\r\n// Validate required fields inside response\r\nexport const validateResponse = (response, requiredFields = [], fallbackMessage = 'Invalid response from server') => {\r\n  if (!response || typeof response !== 'object') {\r\n    return { success: false, data: null, error: fallbackMessage };\r\n  }\r\n\r\n  const isValid = requiredFields.every(field => {\r\n    const fieldPath = field.split('.');\r\n    let current = response;\r\n\r\n    for (const key of fieldPath) {\r\n      if (current && typeof current === 'object' && key in current) {\r\n        current = current[key];\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n    return current !== null && current !== undefined;\r\n  });\r\n\r\n  if (isValid) {\r\n    return { success: true, data: response, error: null };\r\n  } else {\r\n    return { success: false, data: null, error: fallbackMessage };\r\n  }\r\n};\r\n\r\n// Handle raw responses safely\r\nexport const safeResponseHandler = (response, requiredFields = [], errorMessage = 'Invalid response from server') => {\r\n  const validationResult = validateResponse(response, requiredFields, errorMessage);\r\n  if (validationResult.success) {\r\n    return validationResult;\r\n  } else {\r\n    console.error('Response validation failed:', response);\r\n    return validationResult;\r\n  }\r\n};\r\n\r\n// API call wrapper without validation\r\nexport const safeApiCall = async (apiCall, fallbackMessage = 'API call failed') => {\r\n  try {\r\n    const response = await apiCall();\r\n\r\n    // Handle standardized backend response structure\r\n    if (response && response.data) {\r\n      const { success, data, message, error } = response.data;\r\n      \r\n      if (success === true) {\r\n        return { success: true, data: data, error: null };\r\n      } else {\r\n        return { success: false, data: null, error: error || message || fallbackMessage };\r\n      }\r\n    }\r\n    \r\n    // Fallback for non-standardized responses (assume success)\r\n    return { success: true, data: response, error: null };\r\n  } catch (error) {\r\n    const errorMessage = getErrorMessage(error, fallbackMessage);\r\n    console.error('API call failed:', error);\r\n    return { success: false, data: null, error: errorMessage };\r\n  }\r\n};\r\n\r\n// API call wrapper WITH validation\r\nexport const safeApiCallWithValidation = async (apiCall, requiredFields = [], fallbackMessage = 'Request failed') => {\r\n  try {\r\n    const response = await apiCall();\r\n\r\n    // Handle standardized backend response structure\r\n    if (response && response.data) {\r\n      const { success, data, message, error } = response.data;\r\n      \r\n      if (success === true) {\r\n        // Validate required fields in the data\r\n        const validationResult = validateResponse(data, requiredFields, fallbackMessage);\r\n        if (validationResult.success) {\r\n          return { success: true, data: data, error: null };\r\n        } else {\r\n          return validationResult;\r\n        }\r\n      } else {\r\n        return { success: false, data: null, error: error || message || fallbackMessage };\r\n      }\r\n    }\r\n    \r\n    // Fallback for non-standardized responses\r\n    return safeResponseHandler(response, requiredFields, fallbackMessage);\r\n  } catch (error) {\r\n    const errorMessage = getErrorMessage(error, fallbackMessage);\r\n    console.error('API call failed:', error);\r\n    return { success: false, data: null, error: errorMessage };\r\n  }\r\n};\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}